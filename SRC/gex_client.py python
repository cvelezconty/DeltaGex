import requests

class GEXClient:
    def __init__(self, base_url: str, api_key: str, ticker: str):
        self.base_url = base_url.rstrip('/')
        self.api_key = api_key
        self.ticker = ticker

    def fetch_latest(self, span="5min"):
        params = {
            "ticker": self.ticker,
            "span": span,
            "latest": "true",
            "api_key": self.api_key
        }
        r = requests.get(self.base_url, params=params, timeout=15)
        r.raise_for_status()
        return r.json()

